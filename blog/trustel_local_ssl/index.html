<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" href="/favicon.ico"/><title>Creating Trusted Local SSL certs for development</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@brsc2909"/><meta name="twitter:creator" content="@brsc2909"/><meta property="og:title" content="Creating Trusted Local SSL certs for development"/><meta property="og:image" content="https://blog.brendanscullion.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1652122318052%2Fs6pEYdBc6.png%3Fw%3D1600%26h%3D840%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&amp;w=1920&amp;q=75"/><meta property="og:locale" content="en"/><meta property="og:site_name" content="BlackShore Technology"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/1ab6699232f1abb4.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1ab6699232f1abb4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-a0eaca680747f884.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-9e46c965f9e1563d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7fe1566c856316c8.js" defer=""></script><script src="/_next/static/chunks/275-a1f904950f98e0c2.js" defer=""></script><script src="/_next/static/chunks/441-e7ff11799e4942a2.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-073e1c8c10329747.js" defer=""></script><script src="/_next/static/Jo5aWdYAw0oaoet-elfWm/_buildManifest.js" defer=""></script><script src="/_next/static/Jo5aWdYAw0oaoet-elfWm/_ssgManifest.js" defer=""></script><style id="__jsx-4057204961">.navbar.jsx-4057204961 li:not(:first-child){margin-top:0;}.navbar.jsx-4057204961 li:not(:last-child){margin-right:1.25rem;}</style></head><body><div id="__next" data-reactroot=""><div><div class="bg-gray-900"><div class="max-w-screen-lg mx-auto px-3 py-3 undefined"><div class="jsx-4057204961 flex flex-wrap justify-between items-center"><div class="jsx-4057204961"><a class="jsx-4057204961" href="/"><span class="text-gray-100 inline-flex items-center font-semibold text-xl"><svg clip-rule="evenodd" fill-rule="evenodd" width="32" height="32" image-rendering="optimizeQuality" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" viewBox="0 0 110.99997 120.00004" version="1.1" id="svg68" xmlns="http://www.w3.org/2000/svg"><defs id="defs58"><linearGradient gradientUnits="userSpaceOnUse" id="a" x1="87.309998" x2="7662.6299" y1="3022.4099" y2="14087.64"><stop offset="0" stop-color="#004790" id="stop53"></stop><stop offset="1" stop-color="#1297e0" id="stop55"></stop></linearGradient></defs><g id="g66" transform="scale(0.008,0.0077)"><path d="M 6348.16,5590.89 8916.54,7073.7 10687.81,6051.09 V 3085.38 L 5343.87,0 3127.55,1279.53 8471.59,4364.91 Z" fill="#0067b0" id="path60"></path><path d="M 7912.25,7653.67 0,3085.38 V 6051.09 L 8536.06,10979.42 5343.87,12822.36 0,9736.98 v 2604.18 l 5343.87,3085.29 5343.94,-3085.29 v -3085.1 z" fill="url(#a)" id="path62"></path><path d="M 8471.59,4364.91 10687.81,3085.38 7791.94,3972.5 Z" fill="#003780" id="path64"></path></g></svg></span></a></div><nav class="jsx-4057204961"><ul class="jsx-4057204961 navbar flex items-center font-medium text-xl text-gray-300"><li><a href="/about/">About us</a></li><li><a>Services</a></li><li><a href="/blog/">Blog</a></li></ul></nav></div></div></div><div class="max-w-screen-lg mx-auto px-3 py-8 prose prose-slate"><div class="mb-12 text-center"><h2 class="text-4xl text-gray-900 font-bold">Creating Trusted Local SSL certs for development</h2></div><article><img src="https://blog.brendanscullion.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1652122318052%2Fs6pEYdBc6.png%3Fw%3D1600%26h%3D840%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&amp;w=1920&amp;q=75" alt="Creating Trusted Local SSL certs for development"/><div>May 9, 2022</div><div><p><strong>NOTE</strong>: This article to assumes you have NGINX and local DNS configure correctly if not check out <a href="TBC">this article</a> to get started. </p>
<p>If you&#39;re building web applications, then you&#39;ve probably run into this before. You need to run your local environment over HTTPS because you&#39;re connecting to some third party API (maybe Facebook login etc.). You create an SSL cert, add it to your NGINX config, open your browser and bypass the <code>NET::ERR_CERT_AUTHORITY_INVALID</code> warning. </p>
<p>Next you can&#39;t connect to the local back-end server instance because it&#39;s also not trusted. You can&#39;t be arsed finding the commands  and creating a new ssl cert so you use the same one or maybe you&#39;re only using the snakeoil cert that comes with the OS. </p>
<p>This works fine but you&#39;re still going to be annoyed by the browser warnings, and if you&#39;re using websockets then it&#39;s an even bigger hassle. Repeat all this for every project you&#39;re working on, and every domain it uses. It adds up. It&#39;s not the biggest issue in the world but it&#39;s enough to be annoying. 
Also, getting rid of the  &#39;NOT Secure&#39; warning in the URL bar is surprisingly refreshing. </p>
<h3 id="so-lets-look-at-what-we-can-do-about-it">So lets look at what we can do about it?</h3>
<ol>
<li>Create a local certificate authority (CA)</li>
<li>Create SSL certs for each project and sign them using this CA</li>
<li>Add this CA to your browsers trusted authorities</li>
<li>Create new certs signed by the same CA for other projects</li>
</ol>
<p>Luckily for you I&#39;ve put together this handy bash script to add to your arsenal. It&#39;s available on my <a href="https://github.com/brsc2909/makecrt">Github</a> but or convenience you can just download it directly</p>
<pre><code class="language-bash">curl --location -O https://raw.githubusercontent.com/brsc2909/makecrt/main/makecrt &amp;&amp; chmod +x makecrt
</code></pre>
<h3 id="how-do-i-use-it-">how do I use it ?</h3>
<p>I&#39;ve made this as simple as possible. All you need to do is run the script as root and pass the domains as arguments. you need to specify each domain that this cert will be used with. ( I usually create a separate cert per project).</p>
<pre><code class="language-bash">sudo ./makecert --domains local-app.connectmor.io local-api.connectmor.io
</code></pre>
<pre><code>Creating extfile
Creating certificate for local-app.connectmor.io
Signature ok
subject=C = IE, ST = Leinster, L = DUBLIN, O = Local CA beast, OU = IT, CN = local-app.connectmor.io
Getting CA Private Key
NGINX config:
ssl_certificate_key  /etc/ssl/private/local-app.connectmor.io.key;
ssl_certificate  /etc/ssl/certs/local-app.connectmor.io.crt;
</code></pre>
<p>And that&#39;s it. You can use the NGINX config at the end of the output to update your config. </p>
<h3 id="adding-the-ca-to-my-browser-youll-only-need-to-do-this-once">Adding the CA to my browser. (You&#39;ll only need to do this once)</h3>
<p>Each browser is slightly different follow the same principals. Below is how to do it on Chrome or any other chromium based browser (Vivaldi e.t.c) </p>
<p>1. 
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652125391640/7NQWoiBZ1.png" alt="image.png"></p>
<p>2. 
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652125473843/iupVSej0a.png" alt="image.png"></p>
<p>3. 
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652125503497/t8tyAeiD9.png" alt="image.png"></p>
<ol start="4">
<li><p>Add the CA cert you just created. If you used all the defaults then it will be located at <code>/etc/ssl/cers/myLocalRootCA.crt</code>
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652125561567/6FkHCGxPq.png" alt="image.png"></p>
</li>
<li><p>Tell the browser to trust this for identifying websites
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652125608021/MLdJL3Rcp.png" alt="image.png"></p>
</li>
<li><p>You can then check your domain in the list of trusted authorities. Mine looks like this
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652125654184/bEFG9J0G_.png" alt="image.png"></p>
</li>
<li><p>Ah now that is nice
<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1652126779824/NC56aODb_.png" alt="image.png"></p>
</li>
</ol>
<h3 id="custom-config">Custom config</h3>
<p>depending on your OS you might need to edit the script slightly. For example if your ssl certs are not stores in <code>/etc/ssl/</code>.
You have two options here:</p>
<ol>
<li>You can specify the options each time you run the command. use the <code>--help</code> option to view the list of commands.</li>
</ol>
<pre><code>Usage: ./makecrt -d [domain1, domain2...] [options]
 
options:
-h, --help           show brief help
-d, --domains &lt;DOMAIN1 DOMAIN2...&gt; Specify domain for which the cert will be used on
     --days          Specify how long the cert is valid for. default: 3650
     --CA            Specify a local CA. default: /etc/ssl/certs/myLocalRootCA.crt
     --CAkey         Specify a local CA private key. default: /etc/ssl/private/myLocalRootCA.key
-pd, --private-dir   Specify private key dir. default: /etc/ssl/private
-cd, --cert-dir      Specify certificate dir. default: /etc/ssl/certs
-e, --eliptic-curve  Specify what type of eliptic curve to use. Default: prime256v1
 
Example:
./makecrt -d example.com blog.example.com
</code></pre>
<ol start="2">
<li>Edit the default Values in the script. (This probably makes the most sense)</li>
</ol>
<pre><code class="language-bash"># You can change these default values to suit
DAYS=3650

CERT_DIR=/etc/ssl/certs
PRIVATE_KEY_DIR=/etc/ssl/private

e_curve=prime256v1
localRootCA=$CERT_DIR/myLocalRootCA.crt
localRootCAkey=$PRIVATE_KEY_DIR/myLocalRootCA.key

EXTFILE=/tmp/_v3.ext

ORG=&quot;Local CA $(hostname)&quot;
ORG_UNIT=&quot;IT&quot;
COUNTY=&quot;DUBLIN&quot;
STATE=&quot;Leinster&quot;
COUNTRY=&quot;IE&quot;
</code></pre>
</div></article></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"Creating Trusted Local SSL certs for development","date":"May 9, 2022","excerpt":"","cover_image":"https://blog.brendanscullion.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1652122318052%2Fs6pEYdBc6.png%3Fw%3D1600%26h%3D840%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp\u0026w=1920\u0026q=75"},"slug":"trustel_local_ssl","content":"\n**NOTE**: This article to assumes you have NGINX and local DNS configure correctly if not check out [this article](TBC) to get started. \n\nIf you're building web applications, then you've probably run into this before. You need to run your local environment over HTTPS because you're connecting to some third party API (maybe Facebook login etc.). You create an SSL cert, add it to your NGINX config, open your browser and bypass the `NET::ERR_CERT_AUTHORITY_INVALID` warning. \n\nNext you can't connect to the local back-end server instance because it's also not trusted. You can't be arsed finding the commands  and creating a new ssl cert so you use the same one or maybe you're only using the snakeoil cert that comes with the OS. \n\nThis works fine but you're still going to be annoyed by the browser warnings, and if you're using websockets then it's an even bigger hassle. Repeat all this for every project you're working on, and every domain it uses. It adds up. It's not the biggest issue in the world but it's enough to be annoying. \nAlso, getting rid of the  'NOT Secure' warning in the URL bar is surprisingly refreshing. \n\n### So lets look at what we can do about it? \n1. Create a local certificate authority (CA)\n2. Create SSL certs for each project and sign them using this CA\n3. Add this CA to your browsers trusted authorities\n4. Create new certs signed by the same CA for other projects\n\n\nLuckily for you I've put together this handy bash script to add to your arsenal. It's available on my [Github](https://github.com/brsc2909/makecrt) but or convenience you can just download it directly\n```bash\ncurl --location -O https://raw.githubusercontent.com/brsc2909/makecrt/main/makecrt \u0026\u0026 chmod +x makecrt\n```\n\n### how do I use it ?\nI've made this as simple as possible. All you need to do is run the script as root and pass the domains as arguments. you need to specify each domain that this cert will be used with. ( I usually create a separate cert per project).\n```bash\nsudo ./makecert --domains local-app.connectmor.io local-api.connectmor.io\n```\n```\nCreating extfile\nCreating certificate for local-app.connectmor.io\nSignature ok\nsubject=C = IE, ST = Leinster, L = DUBLIN, O = Local CA beast, OU = IT, CN = local-app.connectmor.io\nGetting CA Private Key\nNGINX config:\nssl_certificate_key  /etc/ssl/private/local-app.connectmor.io.key;\nssl_certificate  /etc/ssl/certs/local-app.connectmor.io.crt;\n```\nAnd that's it. You can use the NGINX config at the end of the output to update your config. \n\n### Adding the CA to my browser. (You'll only need to do this once)\nEach browser is slightly different follow the same principals. Below is how to do it on Chrome or any other chromium based browser (Vivaldi e.t.c) \n1. \n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652125391640/7NQWoiBZ1.png)\n\n2. \n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652125473843/iupVSej0a.png)\n\n3. \n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652125503497/t8tyAeiD9.png)\n\n4. Add the CA cert you just created. If you used all the defaults then it will be located at `/etc/ssl/cers/myLocalRootCA.crt`\n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652125561567/6FkHCGxPq.png)\n \n5. Tell the browser to trust this for identifying websites\n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652125608021/MLdJL3Rcp.png)\n\n6. You can then check your domain in the list of trusted authorities. Mine looks like this\n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652125654184/bEFG9J0G_.png)\n\n7. Ah now that is nice\n![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1652126779824/NC56aODb_.png)\n\n### Custom config\ndepending on your OS you might need to edit the script slightly. For example if your ssl certs are not stores in `/etc/ssl/`.\nYou have two options here:\n1. You can specify the options each time you run the command. use the `--help` option to view the list of commands.\n\n```\nUsage: ./makecrt -d [domain1, domain2...] [options]\n \noptions:\n-h, --help           show brief help\n-d, --domains \u003cDOMAIN1 DOMAIN2...\u003e Specify domain for which the cert will be used on\n     --days          Specify how long the cert is valid for. default: 3650\n     --CA            Specify a local CA. default: /etc/ssl/certs/myLocalRootCA.crt\n     --CAkey         Specify a local CA private key. default: /etc/ssl/private/myLocalRootCA.key\n-pd, --private-dir   Specify private key dir. default: /etc/ssl/private\n-cd, --cert-dir      Specify certificate dir. default: /etc/ssl/certs\n-e, --eliptic-curve  Specify what type of eliptic curve to use. Default: prime256v1\n \nExample:\n./makecrt -d example.com blog.example.com\n```\n2. Edit the default Values in the script. (This probably makes the most sense)\n\n```bash\n# You can change these default values to suit\nDAYS=3650\n\nCERT_DIR=/etc/ssl/certs\nPRIVATE_KEY_DIR=/etc/ssl/private\n\ne_curve=prime256v1\nlocalRootCA=$CERT_DIR/myLocalRootCA.crt\nlocalRootCAkey=$PRIVATE_KEY_DIR/myLocalRootCA.key\n\nEXTFILE=/tmp/_v3.ext\n\nORG=\"Local CA $(hostname)\"\nORG_UNIT=\"IT\"\nCOUNTY=\"DUBLIN\"\nSTATE=\"Leinster\"\nCOUNTRY=\"IE\"\n```"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"trustel_local_ssl"},"buildId":"Jo5aWdYAw0oaoet-elfWm","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>